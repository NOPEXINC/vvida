dependencies:
 pre:
  - bower install
  - 
 post:
  - npm install module-deps 
  - npm install gulp -g

machine:
  services:
    - postgresql
  environment:
    DATABASE_URL: postgres://ubuntu:@127.0.0.1:5432/circle_test

database:
  override:
    - cp server/config/db-connect.js database.yml
    - sudo apt-get install postgresql postgresql-contrib
    - sudo -u postgres psql postgres
    - \password root
    - sudo -u postgres createdb vvida
    - sudo apt-get install postgresql-contrib
    - sudo -u postgres psql < /usr/share/postgresql/9.3/contrib/adminpack.sql
    - psql -U ubuntu circle_test < vvida.sql

test:
  override:
    # - ./tests/server/resources/*.spec.js

deployment:
  production:
    branch: master
    heroku:
      appname: vvida
  staging:
    branch: staging
    heroku:
      appname: vvida-staging
